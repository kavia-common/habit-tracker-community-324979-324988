{"is_source_file": true, "format": "Python", "description": "This file defines API routes for managing habits, check-ins, streak calculations, and user-specific habit data within a habit tracking application. It uses FastAPI, SQLAlchemy ORM, and includes endpoints for creating, retrieving, updating, deleting habits, and managing habit check-ins and streaks.", "external_files": ["src.api.core.db", "src.api.deps", "src.api.models", "src.api.schemas"], "external_methods": ["get_db", "get_current_user"], "published": ["router"], "classes": [{"name": "Habit", "description": "Represents a habit created by a user."}, {"name": "HabitCheckin", "description": "A record of a user's check-in for a specific habit on a given date."}, {"name": "HabitStreak", "description": "Tracks the current and longest streak for a particular habit."}, {"name": "User", "description": "Represents an application user."}], "methods": [{"name": "Habit _get_user_habit(db: Session, user_id, habit_id)", "description": "Fetches a habit for the current user by habit ID, raising a 404 error if not found.", "scope": "", "scopeKind": ""}, {"name": "HabitStreak _recompute_streak(db: Session, habit: Habit)", "description": "Recalculates the current and longest streaks for a habit based on recent check-in dates.", "scope": "", "scopeKind": ""}, {"name": "list[HabitResponse] list_habits(db: Session = Depends(get_db), current: User = Depends(get_current_user))", "description": "Lists all habits belonging to the current user.", "scope": "", "scopeKind": ""}, {"name": "HabitResponse create_habit( payload: HabitCreateRequest, db: Session = Depends(get_db), current: User = Depends(get_current_user) )", "description": "Creates a new habit for the current user.", "scope": "", "scopeKind": ""}, {"name": "HabitResponse get_habit(habit_id, db: Session = Depends(get_db), current: User = Depends(get_current_user))", "description": "Retrieves details for a specific habit owned by the current user.", "scope": "", "scopeKind": ""}, {"name": "HabitResponse update_habit( habit_id, payload: HabitUpdateRequest, db: Session = Depends(get_db), current: User = Depends(get_current_user), )", "description": "Updates an existing habit owned by the current user.", "scope": "", "scopeKind": ""}, {"name": "None delete_habit(habit_id, db: Session = Depends(get_db), current: User = Depends(get_current_user))", "description": "Deletes a specific habit owned by the current user.", "scope": "", "scopeKind": ""}, {"name": "HabitStreakResponse get_streak(habit_id, db: Session = Depends(get_db), current: User = Depends(get_current_user))", "description": "Retrieves the streak information for a specific habit.", "scope": "", "scopeKind": ""}, {"name": "HabitCheckinResponse create_checkin( habit_id, payload: HabitCheckinCreateRequest, db: Session = Depends(get_db), current: User = Depends(get_current_user), )", "description": "Creates a check-in record for a habit and updates its streak.", "scope": "", "scopeKind": ""}, {"name": "list[HabitCheckinResponse] list_checkins( habit_id, db: Session = Depends(get_db), current: User = Depends(get_current_user), limit: int = 50, )", "description": "Lists recent check-ins for a specific habit.", "scope": "", "scopeKind": ""}], "calls": ["select(Habit).where(Habit.user_id == current.id).order_by(desc(Habit.created_at))", "select(Habit).where(Habit.id == habit_id, Habit.user_id == user_id)", "select(HabitCheckin.checkin_date).where(HabitCheckin.habit_id == habit.id).order_by(desc(HabitCheckin.checkin_date)).limit(400)", "db.execute(select(Habit).where(Habit.user_id == current.id).order_by(desc(Habit.created_at)))", "db.execute(select(Habit).where(Habit.id == habit_id, Habit.user_id == current.id))", "db.execute(select(HabitCheckin).where(HabitCheckin.habit_id == habit.id).order_by(desc(HabitCheckin.checkin_date)).limit(limit))", "db.execute(select(Habit).where(Habit.id == habit_id, Habit.user_id == current.id))", "db.execute(select(Habit).where(Habit.id == habit_id, Habit.user_id == current.id))"], "search-terms": ["habits", "checkins", "streaks", "habit management", "habit streak computation", "FastAPI router"], "state": 2, "file_id": 12, "knowledge_revision": 25, "git_revision": "", "ctags": [{"_type": "tag", "name": "_get_user_habit", "path": "/home/kavia/workspace/code-generation/habit-tracker-community-324979-324988/habit_buddy_backend/src/api/routers/habits.py", "pattern": "/^def _get_user_habit(db: Session, user_id, habit_id) -> Habit:$/", "language": "Python", "typeref": "typename:Habit", "kind": "function", "signature": "(db: Session, user_id, habit_id)"}, {"_type": "tag", "name": "_recompute_streak", "path": "/home/kavia/workspace/code-generation/habit-tracker-community-324979-324988/habit_buddy_backend/src/api/routers/habits.py", "pattern": "/^def _recompute_streak(db: Session, habit: Habit) -> HabitStreak:$/", "language": "Python", "typeref": "typename:HabitStreak", "kind": "function", "signature": "(db: Session, habit: Habit)"}, {"_type": "tag", "name": "create_checkin", "path": "/home/kavia/workspace/code-generation/habit-tracker-community-324979-324988/habit_buddy_backend/src/api/routers/habits.py", "pattern": "/^def create_checkin($/", "language": "Python", "typeref": "typename:HabitCheckinResponse", "kind": "function", "signature": "( habit_id, payload: HabitCheckinCreateRequest, db: Session = Depends(get_db), current: User = Depends(get_current_user), )"}, {"_type": "tag", "name": "create_habit", "path": "/home/kavia/workspace/code-generation/habit-tracker-community-324979-324988/habit_buddy_backend/src/api/routers/habits.py", "pattern": "/^def create_habit($/", "language": "Python", "typeref": "typename:HabitResponse", "kind": "function", "signature": "( payload: HabitCreateRequest, db: Session = Depends(get_db), current: User = Depends(get_current_user) )"}, {"_type": "tag", "name": "delete_habit", "path": "/home/kavia/workspace/code-generation/habit-tracker-community-324979-324988/habit_buddy_backend/src/api/routers/habits.py", "pattern": "/^def delete_habit(habit_id, db: Session = Depends(get_db), current: User = Depends(get_current_us/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(habit_id, db: Session = Depends(get_db), current: User = Depends(get_current_user))"}, {"_type": "tag", "name": "get_habit", "path": "/home/kavia/workspace/code-generation/habit-tracker-community-324979-324988/habit_buddy_backend/src/api/routers/habits.py", "pattern": "/^def get_habit(habit_id, db: Session = Depends(get_db), current: User = Depends(get_current_user)/", "language": "Python", "typeref": "typename:HabitResponse", "kind": "function", "signature": "(habit_id, db: Session = Depends(get_db), current: User = Depends(get_current_user))"}, {"_type": "tag", "name": "get_streak", "path": "/home/kavia/workspace/code-generation/habit-tracker-community-324979-324988/habit_buddy_backend/src/api/routers/habits.py", "pattern": "/^def get_streak(habit_id, db: Session = Depends(get_db), current: User = Depends(get_current_user/", "language": "Python", "typeref": "typename:HabitStreakResponse", "kind": "function", "signature": "(habit_id, db: Session = Depends(get_db), current: User = Depends(get_current_user))"}, {"_type": "tag", "name": "list_checkins", "path": "/home/kavia/workspace/code-generation/habit-tracker-community-324979-324988/habit_buddy_backend/src/api/routers/habits.py", "pattern": "/^def list_checkins($/", "language": "Python", "typeref": "typename:list[HabitCheckinResponse]", "kind": "function", "signature": "( habit_id, db: Session = Depends(get_db), current: User = Depends(get_current_user), limit: int = 50, )"}, {"_type": "tag", "name": "list_habits", "path": "/home/kavia/workspace/code-generation/habit-tracker-community-324979-324988/habit_buddy_backend/src/api/routers/habits.py", "pattern": "/^def list_habits(db: Session = Depends(get_db), current: User = Depends(get_current_user)) -> lis/", "language": "Python", "typeref": "typename:list[HabitResponse]", "kind": "function", "signature": "(db: Session = Depends(get_db), current: User = Depends(get_current_user))"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/habit-tracker-community-324979-324988/habit_buddy_backend/src/api/routers/habits.py", "pattern": "/^router = APIRouter(prefix=\"\\/habits\", tags=[\"habits\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "update_habit", "path": "/home/kavia/workspace/code-generation/habit-tracker-community-324979-324988/habit_buddy_backend/src/api/routers/habits.py", "pattern": "/^def update_habit($/", "language": "Python", "typeref": "typename:HabitResponse", "kind": "function", "signature": "( habit_id, payload: HabitUpdateRequest, db: Session = Depends(get_db), current: User = Depends(get_current_user), )"}], "hash": "8672aa6c1a6a84714d0427b720b1572c", "format-version": 4, "code-base-name": "habit_buddy_backend", "filename": "habit_buddy_backend/src/api/routers/habits.py", "fields": [{"name": "router = APIRouter(prefix=\"\\/habits\", tags=[\"habits\"])", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"25": ""}]}